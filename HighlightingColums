import pandas as pd

# Create a sample DataFrame
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6],
    'C': [7, 8, 9]
})

# Specify the path for the Excel file
file_path = 'highlight_columns.xlsx'

# Use pandas ExcelWriter with xlsxwriter engine
with pd.ExcelWriter(file_path, engine='xlsxwriter') as writer:
    df.to_excel(writer, sheet_name='Sheet1', index=False)
    
    # Access the xlsxwriter workbook and worksheet objects
    workbook  = writer.book
    worksheet = writer.sheets['Sheet1']
    
    # Create a format for the highlighted column
    highlight_format = workbook.add_format({'bg_color': 'yellow'})
    
    # Apply the format to specific columns (e.g., columns B and C)
    worksheet.set_column('B:B', None, highlight_format)
    worksheet.set_column('C:C', None, highlight_format)

print(f"Excel file saved as {file_path}")
import pandas as pd

# Create a sample DataFrame
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6],
    'C': [7, 8, 9]
})

# Specify the path for the Excel file
file_path = 'highlight_columns_by_header.xlsx'

# Use pandas ExcelWriter with xlsxwriter engine
with pd.ExcelWriter(file_path, engine='xlsxwriter') as writer:
    df.to_excel(writer, sheet_name='Sheet1', index=False)
    
    # Access the xlsxwriter workbook and worksheet objects
    workbook  = writer.book
    worksheet = writer.sheets['Sheet1']
    
    # Create a format for the highlighted column
    highlight_format = workbook.add_format({'bg_color': 'yellow'})
    
    # Get the column headers from the DataFrame
    headers = df.columns.tolist()

    # Find the Excel column index (1-based, Excel uses A1-style addressing)
    for header in headers:
        if header in ['B', 'C']:  # Specify the headers you want to highlight
            col_idx = headers.index(header) + 1  # Add 1 because Excel is 1-based
            excel_col = chr(64 + col_idx)  # Convert column index to Excel letter (e.g., 1 -> 'A')
            
            # Apply the format based on the column name
            worksheet.set_column(f'{excel_col}:{excel_col}', None, highlight_format)

print(f"Excel file saved as {file_path}")
